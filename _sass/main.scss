@import 'variables';
@import 'colors';
@import 'theme';
@import 'navigation';
@import 'podcast-player';
@import 'video-player';
@import 'progress-tracker';
@import 'breadcrumbs';
@import 'module-summary';
@import 'components/interactions';
@import 'components/skeleton';
@import 'components/empty-states';
@import 'components/hero';
@import 'components/command-palette';
@import 'components/toast';
@import 'components/footer';
@import 'utilities/transitions';
@import 'animations/keyframes';

* {
  box-sizing: border-box;
}

/* Garantir que pre tags sempre usem as cores corretas do tema */
pre {
  background: var(--color-code-block-bg) !important;
  color: var(--color-text-primary) !important;
  border: 1px solid var(--color-code-block-border) !important;
  border-radius: 8px !important;
  overflow: hidden !important;
  
  code {
    background: transparent !important;
    color: var(--color-text-primary) !important;
  }
  
  /* Remover todos os backgrounds de elementos de syntax highlighting */
  * {
    background: transparent !important;
    background-color: transparent !important;
  }
  
  span,
  .hll,
  .err,
  .k,
  .o,
  .c,
  .cm,
  .cp,
  .c1,
  .cs,
  .gd,
  .ge,
  .gr,
  .gh,
  .gi,
  .go,
  .gp,
  .gs,
  .gu,
  .gt,
  .kc,
  .kd,
  .kn,
  .kp,
  .kr,
  .kt,
  .ld,
  .m,
  .s,
  .na,
  .nb,
  .nc,
  .no,
  .nd,
  .ni,
  .ne,
  .nf,
  .nl,
  .nn,
  .nx,
  .py,
  .nt,
  .nv,
  .ow,
  .w,
  .mb,
  .mf,
  .mh,
  .mi,
  .mo,
  .sa,
  .sb,
  .sc,
  .dl,
  .sd,
  .s2,
  .se,
  .sh,
  .si,
  .sx,
  .sr,
  .s1,
  .ss,
  .bp,
  .fm,
  .vc,
  .vg,
  .vi,
  .vm,
  .il {
    background: transparent !important;
    background-color: transparent !important;
  }
}

/* Remover backgrounds do highlighter-rouge do Minima */
.highlighter-rouge {
  background: transparent !important;
  
  .highlight {
    background: transparent !important;
    background-color: transparent !important;
  }
  
  .highlight pre,
  pre {
    background: var(--color-code-block-bg) !important;
    background-color: var(--color-code-block-bg) !important;
  }
  
  .highlight *,
  .highlight pre * {
    background: transparent !important;
    background-color: transparent !important;
  }
}

body {
  font-family: $font-family;
  font-size: $font-size-base;
  font-weight: $font-weight-normal;
  line-height: $line-height-normal;
  color: var(--color-text-primary);
  background: var(--color-bg-primary);
  margin: 0;
  padding: 0;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
  @include theme-transition-all;
  
  // Gradiente sutil no background (estilo CWI)
  background: linear-gradient(
    180deg,
    var(--color-bg-primary) 0%,
    var(--color-bg-secondary) 100%
  );
  min-height: 100vh;
}

/* Hierarquia tipográfica - Títulos */
h1, h2, h3, h4, h5, h6 {
  font-family: $font-family;
  font-weight: $font-weight-semibold;
  line-height: $line-height-tight;
  color: var(--color-text-primary);
  margin-top: 0;
  margin-bottom: $spacing-md;
  @include theme-transition(color);
}

h1 {
  font-size: $font-size-h1;
  font-weight: $font-weight-bold;
  line-height: $line-height-tight;
  margin-bottom: $spacing-lg;
  letter-spacing: -0.02em;
}

h2 {
  font-size: $font-size-h2;
  font-weight: $font-weight-semibold;
  line-height: $line-height-tight;
  margin-bottom: $spacing-md;
  margin-top: $spacing-xl;
  letter-spacing: -0.01em;
}

h3 {
  font-size: $font-size-h3;
  font-weight: $font-weight-semibold;
  line-height: $line-height-tight;
  margin-bottom: $spacing-md;
  margin-top: $spacing-lg;
}

h4 {
  font-size: $font-size-h4;
  font-weight: $font-weight-semibold;
  line-height: $line-height-normal;
  margin-bottom: $spacing-sm;
  margin-top: $spacing-lg;
}

h5 {
  font-size: $font-size-h5;
  font-weight: $font-weight-medium;
  line-height: $line-height-normal;
  margin-bottom: $spacing-sm;
  margin-top: $spacing-md;
}

h6 {
  font-size: $font-size-h6;
  font-weight: $font-weight-medium;
  line-height: $line-height-normal;
  margin-bottom: $spacing-sm;
  margin-top: $spacing-md;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  font-size: $font-size-small;
}

.site-header {
  background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
  color: var(--color-text-inverse);
  padding: $spacing-md $spacing-lg;
  box-shadow: var(--color-shadow-sm);
  position: sticky;
  top: 0;
  z-index: 1000;
  @include theme-transition-all;
  
  /* Gradiente adicional para dark mode */
  [data-theme="dark"] & {
    background: linear-gradient(135deg, var(--color-primary-dark) 0%, var(--color-primary) 100%);
  }
  
  .header-content {
    max-width: $container-max-width;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: $spacing-lg;
  }
  
  .header-brand {
    display: flex;
    align-items: center;
    gap: $spacing-md;
    flex: 1;
  }
  
  .site-title {
    margin: 0;
    font-size: $font-size-h2;
    font-weight: $font-weight-semibold;
    letter-spacing: -0.01em;
    
    a {
      color: var(--color-text-inverse);
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: $spacing-sm;
      transition: opacity 0.2s;
      
      &:hover {
        opacity: 0.9;
      }
    }
    
    .brand-icon {
      font-size: 1.5em;
      line-height: 1;
      display: flex;
      align-items: center;
    }
    
    .brand-text {
      display: inline-block;
    }
  }
  
  .brand-badge {
    background: rgba(255, 255, 255, 0.2);
    color: var(--color-text-inverse);
    padding: 0.25rem 0.75rem;
    border-radius: 12px;
    font-size: $font-size-xs;
    font-weight: $font-weight-medium;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    white-space: nowrap;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
  }
  
  .main-nav {
    display: flex;
    gap: $spacing-lg;
    align-items: center;
    
    a {
      color: var(--color-text-inverse);
      text-decoration: none;
      
      &:hover {
        text-decoration: underline;
      }
    }
  }
  
  .theme-toggle {
    background: transparent;
    border: none;
    color: var(--color-text-inverse);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    padding: $spacing-xs;
    margin-left: $spacing-md;
    transition: opacity 0.2s, transform 0.2s;
    
    &:hover {
      opacity: 0.8;
      transform: scale(1.1);
    }
    
    &:active {
      transform: scale(0.95);
    }
    
    &:focus {
      outline: 2px solid rgba(255, 255, 255, 0.5);
      outline-offset: 2px;
      border-radius: 4px;
    }
    
    #theme-icon {
      display: inline-block;
      line-height: 1;
    }
  }
}

.page-wrapper {
  display: flex !important;
  flex-direction: row !important;
  align-items: flex-start !important;
  width: 100% !important;
  min-height: calc(100vh - 80px);
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

.sidebar {
  flex: 0 0 $sidebar-width !important;
  width: $sidebar-width !important;
  min-width: $sidebar-width !important;
  max-width: $sidebar-width !important;
  position: sticky !important;
  top: 80px;
  height: calc(100vh - 80px);
  overflow-y: auto;
  overflow-x: hidden;
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

.main-container {
  flex: 1 1 auto !important;
  display: flex !important;
  justify-content: center !important;
  align-items: flex-start !important;
  min-width: 0;
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

.main-container .content {
  max-width: $container-max-width;
  width: 100%;
  padding: $spacing-lg;
  box-sizing: border-box;
  transform: scale(0.8);
  transform-origin: top left;
  margin-bottom: -20%;
  
  h1, h2, h3, h4, h5, h6 {
    color: var(--color-text-primary);
    @include theme-transition(color);
  }
  
  p {
    color: var(--color-text-primary);
    font-size: $font-size-base;
    line-height: $line-height-relaxed;
    margin-bottom: $spacing-md;
    @include theme-transition(color);
  }
  
  /* Textos grandes e pequenos */
  .text-large {
    font-size: $font-size-large;
    line-height: $line-height-relaxed;
  }
  
  .text-small {
    font-size: $font-size-small;
    line-height: $line-height-normal;
  }
  
  .text-xs {
    font-size: $font-size-xs;
    line-height: $line-height-normal;
  }
  
  /* Pesos de fonte */
  .font-light { font-weight: $font-weight-light; }
  .font-normal { font-weight: $font-weight-normal; }
  .font-medium { font-weight: $font-weight-medium; }
  .font-semibold { font-weight: $font-weight-semibold; }
  .font-bold { font-weight: $font-weight-bold; }
  
  a {
    color: var(--color-primary);
    @include theme-transition(color);
    
    &:hover {
      color: var(--color-primary-hover);
    }
  }
  
  code {
    background: var(--color-code-bg);
    color: var(--color-code-text);
    padding: 0.2em 0.4em;
    border-radius: 3px;
    font-size: 0.9em;
    font-family: $font-family-mono;
    font-weight: $font-weight-normal;
    @include theme-transition-all;
  }
  
  /* Estilos para containers de highlight do Jekyll/Minima */
  .highlighter-rouge {
    background: transparent !important;
    
    .highlight {
      background: transparent !important;
      background-color: transparent !important;
    }
  }
  
  pre {
    background: var(--color-code-block-bg) !important;
    color: var(--color-text-primary) !important;
    padding: $spacing-md;
    border-radius: 8px;
    overflow: hidden;
    overflow-x: auto;
    border: 1px solid var(--color-code-block-border) !important;
    margin: $spacing-lg 0;
    @include theme-transition-all;
    
    code {
      background: transparent !important;
      color: var(--color-text-primary) !important;
      padding: 0;
      font-size: 0.9em;
      font-family: $font-family-mono;
      font-weight: $font-weight-normal;
      border: none;
      display: block;
      line-height: $line-height-relaxed;
    }
    
    /* Remover todos os backgrounds de elementos de syntax highlighting */
    * {
      background: transparent !important;
      background-color: transparent !important;
    }
    
    /* Garantir que spans de highlight não tenham background */
    span,
    .hll,
    .err,
    .k,
    .o,
    .c,
    .cm,
    .cp,
    .c1,
    .cs,
    .gd,
    .ge,
    .gr,
    .gh,
    .gi,
    .go,
    .gp,
    .gs,
    .gu,
    .gt,
    .kc,
    .kd,
    .kn,
    .kp,
    .kr,
    .kt,
    .ld,
    .m,
    .s,
    .na,
    .nb,
    .nc,
    .no,
    .nd,
    .ni,
    .ne,
    .nf,
    .nl,
    .nn,
    .nx,
    .py,
    .nt,
    .nv,
    .ow,
    .w,
    .mb,
    .mf,
    .mh,
    .mi,
    .mo,
    .sa,
    .sb,
    .sc,
    .dl,
    .sd,
    .s2,
    .se,
    .sh,
    .si,
    .sx,
    .sr,
    .s1,
    .ss,
    .bp,
    .fm,
    .vc,
    .vg,
    .vi,
    .vm,
    .il {
      background: transparent !important;
      background-color: transparent !important;
      color: inherit;
    }
  }
  
  /* Garantir que .highlight dentro de .highlighter-rouge não tenha background */
  .highlighter-rouge .highlight,
  .highlighter-rouge .highlight pre,
  .highlighter-rouge pre {
    background: var(--color-code-block-bg) !important;
    background-color: var(--color-code-block-bg) !important;
  }
  
  .highlighter-rouge .highlight *,
  .highlighter-rouge .highlight pre * {
    background: transparent !important;
    background-color: transparent !important;
  }
  
  /* Garantir que pre dentro de qualquer contexto use as cores corretas */
  .lesson-content pre,
  .module-content pre,
  .exercise-content pre,
  .content pre {
    background: var(--color-code-block-bg) !important;
    color: var(--color-text-primary) !important;
    border-color: var(--color-code-block-border) !important;
  }
  
  blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: $spacing-md;
    margin-left: 0;
    margin-right: 0;
    color: var(--color-text-secondary);
    background: var(--color-bg-secondary);
    padding-top: $spacing-sm;
    padding-bottom: $spacing-sm;
    padding-right: $spacing-md;
    border-radius: 0 4px 4px 0;
    @include theme-transition-all;
  }
  
  table {
    width: 100%;
    border-collapse: collapse;
    margin: $spacing-lg 0;
    
    th, td {
      padding: $spacing-sm $spacing-md;
      border: 1px solid var(--color-border);
      @include theme-transition(border-color);
    }
    
    th {
      background: var(--color-bg-secondary);
      color: var(--color-text-primary);
      font-weight: 600;
      @include theme-transition-all;
    }
    
    td {
      background: var(--color-surface);
      color: var(--color-text-primary);
      @include theme-transition-all;
    }
    
    tr:nth-child(even) td {
      background: var(--color-bg-secondary);
    }
  }
  
  ul, ol {
    color: var(--color-text-primary);
    @include theme-transition(color);
  }
  
  hr {
    border: none;
    border-top: 1px solid var(--color-border);
    margin: $spacing-xl 0;
    @include theme-transition(border-color);
  }
  
  img {
    max-width: 100%;
    height: auto;
    border-radius: 4px;
    @include theme-transition-all;
    
    &[src*="visualizacao"],
    &[src*="visualization"],
    &[src*="diagram"],
    &[src*="diagrama"] {
      background: var(--color-surface);
      padding: $spacing-md;
      border: 1px solid var(--color-border);
      @include theme-transition-all;
    }
  }
  
  /* Containers de visualização e diagramas */
  .visualizacao,
  .visualization,
  .diagram,
  .diagrama {
    background: var(--color-visualization-bg);
    border: 1px solid var(--color-visualization-border);
    border-radius: 8px;
    padding: $spacing-lg;
    margin: $spacing-lg 0;
    color: var(--color-text-primary);
    @include theme-transition-all;
    
    img {
      background: transparent;
      border: none;
      padding: 0;
    }
    
    p, div, span {
      color: var(--color-text-primary);
    }
  }
  
  /* Seções com conteúdo que pode ter imagens brancas */
  section,
  div[class*="visual"],
  div[class*="diagram"] {
    img {
      /* Aplicar filtro sutil no dark mode para melhorar contraste */
      [data-theme="dark"] & {
        opacity: 0.9;
      }
    }
  }
}

.lesson-content,
.module-content,
.exercise-content {
  background: var(--color-surface);
  color: var(--color-text-primary);
  padding: $spacing-xl;
  border-radius: 8px;
  box-shadow: var(--color-shadow-sm);
  @include theme-transition-all;
  
  header {
    margin-bottom: $spacing-xl;
    padding-bottom: $spacing-lg;
    border-bottom: 2px solid var(--color-border);
    @include theme-transition(border-color);
    
    h1 {
      margin: 0 0 $spacing-md 0;
      font-size: $font-size-h1;
      color: var(--color-text-primary);
      @include theme-transition(color);
    }
    
    .lesson-meta,
    .module-meta,
    .exercise-meta {
      display: flex;
      gap: $spacing-lg;
      color: var(--color-text-secondary);
      font-size: $font-size-small;
      margin-top: $spacing-sm;
      @include theme-transition(color);
    }
  }
}

.lesson-navigation {
  margin: $spacing-xl 0;
  padding: $spacing-lg;
  background: var(--color-bg-secondary);
  border-radius: 12px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: $spacing-xl;
  min-height: 60px;
  @include theme-transition(background-color);
  
  a {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    color: var(--color-primary);
    text-decoration: none;
    font-weight: 600;
    font-size: 1rem;
    padding: 0.875rem 1.5rem;
    border-radius: 8px;
    background: var(--color-surface);
    border: 2px solid var(--color-primary);
    transition: all 0.2s ease;
    @include theme-transition(all);
    white-space: nowrap;
    flex-shrink: 0;
    min-width: fit-content;
    max-width: 45%;
    
    &:hover {
      text-decoration: none;
      background: var(--color-primary);
      color: var(--color-text-inverse);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    
    &:active {
      transform: translateY(0);
    }
    
    &:focus-visible {
      outline: 2px solid var(--color-primary);
      outline-offset: 2px;
      border-radius: 8px;
    }
  }
  
  // Quando há apenas o link de resumo do módulo, alinha à direita
  .module-summary-link:only-child {
    margin-left: auto;
    margin-right: 0;
    max-width: none;
  }
  
  // Quando há apenas um link, centralizar
  a:only-child {
    margin: 0 auto;
    max-width: none;
  }
  
  // Botão anterior - sempre à esquerda
  .prev-lesson {
    margin-right: auto;
    margin-left: 0;
    order: 1;
    text-align: left;
  }
  
  // Botão próximo - sempre à direita
  .next-lesson {
    margin-left: auto;
    margin-right: 0;
    order: 2;
    text-align: right;
  }
  
  // Garantir espaçamento máximo entre os dois botões
  .prev-lesson + .next-lesson {
    margin-left: auto;
  }
}

.exercises {
  margin-top: $spacing-xl;
  
  h2 {
    font-size: $font-size-h2;
    margin-bottom: $spacing-lg;
    color: var(--color-text-primary);
    @include theme-transition(color);
  }
  
  .exercise-card {
    background: var(--color-surface);
    color: var(--color-text-primary);
    padding: $spacing-lg;
    border: 1px solid var(--color-border);
    border-radius: 8px;
    margin-bottom: $spacing-md;
    @include theme-transition-all;
    
    h3 {
      margin: 0 0 $spacing-sm 0;
      font-size: $font-size-h3;
      color: var(--color-text-primary);
    }
    
    a {
      color: var(--color-primary);
      text-decoration: none;
      @include theme-transition(color);
      
      &:hover {
        text-decoration: underline;
      }
    }
  }
}

.lesson-actions {
  margin-top: $spacing-xl;
  padding-top: $spacing-lg;
  border-top: 1px solid var(--color-border);
  @include theme-transition(border-color);
  
  .mark-lesson-complete {
    background: var(--color-success);
    color: var(--color-text-inverse);
    border: none;
    padding: $spacing-sm $spacing-lg;
    border-radius: 4px;
    font-size: $font-size-base;
    cursor: pointer;
    transition: background-color 0.2s;
    
    &:hover {
      background: var(--color-success-hover);
    }
    
    &:disabled {
      background: var(--color-text-tertiary);
      cursor: not-allowed;
    }
  }
}

// Footer styles moved to components/_footer.scss
  
  .page-wrapper {
    flex-direction: column;
  }
  
  .sidebar {
    width: 100%;
    position: relative;
    top: 0;
    height: auto;
    align-self: stretch;
  }
  
  .sidebar-navigation {
    height: auto;
  }
  
  .main-container {
    width: 100%;
  }
  
  .main-container .content {
    padding: $spacing-md;
  }
  
  .lesson-content,
  .module-content,
  .exercise-content {
    padding: $spacing-lg;
  }
  
  .site-header {
    .header-content {
      flex-direction: column;
      gap: $spacing-md;
    }
    
    .header-brand {
      flex-direction: column;
      align-items: flex-start;
      gap: $spacing-sm;
    }
    
    .brand-badge {
      align-self: flex-start;
    }
  }
  
  // Footer responsive styles moved to components/_footer.scss
}

@media (max-width: $breakpoint-mobile) {
  .lesson-content,
  .module-content,
  .exercise-content {
    header h1 {
      font-size: $font-size-h2;
    }
  }
}

